local SCRIPT_ID = "cc390306378f09616275ca5f6e86258f"

local success, api = pcall(function()
    return loadstring(game:HttpGet("https://sdkapi-public.luarmor.net/library.lua"))()
end)

if not success then
    warn("Failed to load Luarmor library:", api)
    return
end

api.script_id = SCRIPT_ID


if getgenv().script_key or _G.script_key or script_key then
    local key = getgenv().script_key or _G.script_key or script_key
    
    local ok, result = pcall(function()
        return api.check_key(key)
    end)
    
    if ok and result.code == "KEY_VALID" then
        getgenv().script_key = key
        pcall(function()
            api.load_script()
        end)
        return
    end
end


local gui = Instance.new("ScreenGui")
gui.Name = "LuarmorKeyUI"
gui.ResetOnSpawn = false
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

if type(syn) == "table" and typeof(syn.protect_gui) == "function" then
    syn.protect_gui(gui)
    gui.Parent = game:GetService("CoreGui")
else
    gui.Parent = game:GetService("CoreGui")
end

local frame = Instance.new("Frame")
frame.Name = "MainFrame"
frame.Size = UDim2.new(0, 320, 0, 200)
frame.Position = UDim2.new(0.5, -160, 0.5, -100)
frame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
frame.BorderSizePixel = 0
frame.Parent = gui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 6)
corner.Parent = frame

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Text = "Noctis Key System"
title.Size = UDim2.new(1, 0, 0, 36)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 20
title.Parent = frame

local subtitle = Instance.new("TextLabel")
subtitle.Name = "Subtitle"
subtitle.Text = "Enter Key"
subtitle.Size = UDim2.new(1, -20, 0, 24)
subtitle.Position = UDim2.new(0, 10, 0, 40)
subtitle.BackgroundTransparency = 1
subtitle.TextColor3 = Color3.fromRGB(200, 200, 200)
subtitle.Font = Enum.Font.SourceSans
subtitle.TextSize = 16
subtitle.TextXAlignment = Enum.TextXAlignment.Center
subtitle.Parent = frame

local keyBox = Instance.new("TextBox")
keyBox.Name = "KeyBox"
keyBox.PlaceholderText = "Paste key here"
keyBox.Text = ""
keyBox.Size = UDim2.new(1, -20, 0, 32)
keyBox.Position = UDim2.new(0, 10, 0, 70)
keyBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
keyBox.BorderSizePixel = 0
keyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
keyBox.Font = Enum.Font.SourceSans
keyBox.TextSize = 18
keyBox.ClearTextOnFocus = false
keyBox.Parent = frame

local keyBoxCorner = Instance.new("UICorner")
keyBoxCorner.CornerRadius = UDim.new(0, 4)
keyBoxCorner.Parent = keyBox

local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Text = ""
statusLabel.Size = UDim2.new(1, -20, 0, 50)
statusLabel.Position = UDim2.new(0, 10, 0, 110)
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.Font = Enum.Font.SourceSans
statusLabel.TextSize = 14
statusLabel.TextWrapped = true
statusLabel.TextYAlignment = Enum.TextYAlignment.Top
statusLabel.Parent = frame

local checkButton = Instance.new("TextButton")
checkButton.Name = "CheckButton"
checkButton.Text = "Verify"
checkButton.Size = UDim2.new(0.4, -10, 0, 32)
checkButton.Position = UDim2.new(0.05, 0, 1, -42)
checkButton.AnchorPoint = Vector2.new(0, 1)
checkButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
checkButton.BorderSizePixel = 0
checkButton.TextColor3 = Color3.fromRGB(255, 255, 255)
checkButton.Font = Enum.Font.SourceSansBold
checkButton.TextSize = 18
checkButton.Parent = frame

local checkButtonCorner = Instance.new("UICorner")
checkButtonCorner.CornerRadius = UDim.new(0, 4)
checkButtonCorner.Parent = checkButton

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Text = "X"
closeButton.Size = UDim2.new(0, 24, 0, 24)
closeButton.Position = UDim2.new(1, -28, 0, 4)
closeButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
closeButton.BorderSizePixel = 0
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.Font = Enum.Font.SourceSansBold
closeButton.TextSize = 16
closeButton.Parent = frame

local closeButtonCorner = Instance.new("UICorner")
closeButtonCorner.CornerRadius = UDim.new(0, 4)
closeButtonCorner.Parent = closeButton

local function setStatus(msg, colour)
    statusLabel.Text = msg or ""
    statusLabel.TextColor3 = colour or Color3.fromRGB(255, 255, 255)
end

local function onCheckClicked()
    local key = keyBox.Text:gsub("%s+", "")
    if key == "" then
        setStatus("Please enter a key", Color3.fromRGB(255, 120, 120))
        return
    end
    
    setStatus("Checking keyâ€¦", Color3.fromRGB(200, 200, 200))
    checkButton.Text = "Checking..."
    checkButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    
    local ok, result = pcall(function()
        return api.check_key(key)
    end)
    
    if not ok then
        setStatus("Error: " .. tostring(result), Color3.fromRGB(255, 120, 120))
        checkButton.Text = "Verify"
        checkButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        return
    end
    
    if result.code == "KEY_VALID" then
        local msg = "Key valid!"
        if result.data then
            if result.data.auth_expire then
                local secondsLeft = result.data.auth_expire - os.time()
                if secondsLeft > 0 then
                    msg = msg .. "\nExpires in " .. math.floor(secondsLeft / 86400) .. "d " .. math.floor((secondsLeft % 86400) / 3600) .. "h"
                elseif secondsLeft <= 0 or secondsLeft == -1 then
                    msg = msg .. "\nLifetime key"
                end
            end
            if result.data.total_executions then
                msg = msg .. "\nExecutions: " .. result.data.total_executions
            end
        end
        setStatus(msg, Color3.fromRGB(120, 255, 120))
        
        getgenv().script_key = key
        
        task.wait(1)
        
        local execOk, execErr = pcall(function()
            api.load_script()
        end)
        
        if execOk then
            gui:Destroy()
        else
            setStatus("Failed to load script: " .. tostring(execErr), Color3.fromRGB(255, 120, 120))
            checkButton.Text = "Verify"
            checkButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        end
    else
        local statusMessages = {
            KEY_HWID_LOCKED = "Key locked to different HWID",
            KEY_INCORRECT = "Invalid key",
            KEY_EXPIRED = "Key expired",
            KEY_BANNED = "Key banned",
            KEY_INVALID = "Key format invalid",
            SCRIPT_ID_INCORRECT = "Script ID incorrect",
            SCRIPT_ID_INVALID = "Script ID invalid",
            INVALID_EXECUTOR = "Unsupported executor"
        }
        
        local msg = statusMessages[result.code] or ("Error: " .. tostring(result.message))
        setStatus(msg, Color3.fromRGB(255, 120, 120))
        checkButton.Text = "Verify"
        checkButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    end
end

checkButton.MouseButton1Click:Connect(onCheckClicked)
closeButton.MouseButton1Click:Connect(function()
    gui:Destroy()
end)

keyBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        onCheckClicked()
    end
end)

do
    local UIS = game:GetService("UserInputService")
    local dragging, dragStart, startPos
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)
    
    frame.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    UIS.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
end
